# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

_Public Classes_

* [`tcpwrappers`](#tcpwrappers): Main class which will install tcpwrappers and begin management of hosts.allow and hosts.deny. The hosts.allow and hosts.deny files are set up by the class to emulate the files as they would be installed initially. Any tcpwrappers rules already existing in those files will be removed by the class when first applied to a system.
* [`tcpwrappers::allows`](#tcpwrappersallows): Class which when included uses either the rules parameter or merged data from lookup to create tcpwrappers concat fragments.

_Private Classes_

* `tcpwrappers::config`: This class is called from tcpwrappers class to configure some basic pieces.
* `tcpwrappers::install`: This class is called from the main tcpwrappers class for install.

**Defined types**

* [`tcpwrappers::allow`](#tcpwrappersallow): The tcpwrappers::allow class creates a concat fragment for constructing hosts.allow

## Classes

### tcpwrappers

Class: tcpwrappers
===========================

Main class which will install tcpwrappers and begin management of hosts.allow and hosts.deny. The hosts.allow and hosts.deny files are set up by the class to emulate the files as they would be installed initially. Any tcpwrappers rules already existing in those files will be removed by the class when first applied to a system.

#### Examples

##### 

```puppet
include tcpwrappers
```

#### Parameters

The following parameters are available in the `tcpwrappers` class.

##### `allow_header`

Data type: `Boolean`

Whether or not to include a header for hosts.allow  with order of 0_header.

Default value: `true`

##### `allow_header_source`

Data type: `String`

File to use as header for hosts.allow in the form of <modulename>/path/to/file which is then used by the source parameter of the fragment. As such, "files" should not appear in the path. This allows for replacing the module provided header with a locally generated one.

Default value: "tcpwrappers/allow_header_${::operatingsystem}"

##### `allow_localhost_ipv4`

Data type: `Boolean`

Include the concat fragment to allow localhost ipv4 address (127.0.0.1) to access all daemons.

Default value: `false`

##### `allow_localhost_ipv6`

Data type: `Boolean`

Include the concat fragment to allow localhost ipv6 address (::1) to access all daemons.

Default value: `false`

##### `config_dir`

Data type: `String`

Specifies the directory for where the tcpwrappers configuration files are located.

Default value: '/etc'

##### `default_deny`

Data type: `Boolean`

Whether or not to include 'ALL : ALL' in the hosts.deny file.

Default value: `false`

##### `deny_header`

Data type: `Boolean`

Whether or not to include a header for hosts.deny with order of ZZ_deny_all.

Default value: `true`

##### `deny_header_source`

Data type: `String`

File to use as header for hosts.deny in the for of <modulename>/path/to/file which is then used by the source parameter of the fragment. As such, "files" should not appear in the path. This allows for replacing the module provided header with a locally generated one.

Default value: "tcpwrappers/deny_header_${::operatingsystem}"

##### `file_allow`

Data type: `String`

Name for the hosts.allow file configuration file.

Default value: 'hosts.allow'

##### `file_deny`

Data type: `String`

Name for the hosts.deny configuration file.

Default value: 'hosts.deny'

##### `package_ensure`

Data type: `String`

Whether to install the tcpwrappers package, and what version. Suggested values: 'present', 'latest', or a specific version number. No validation of the String provided is done.

Default value: 'present'

##### `package_name`

Data type: `String`

Specified the name of the package to install.

Default value: 'tcp_wrappers'

##### `allow_sshd_all`

Data type: `Boolean`



Default value: `false`

### tcpwrappers::allows

Class tcpwrappers::allows
===========================

Class which when included uses either the rules parameter or merged data from lookup to create tcpwrappers concat fragments.

#### Examples

##### hiera file providing data for the merge lookup

```puppet
tcpwrappers::allows::rules:
  sshd_all
    client_list: ALL
    daemon_list: sshd
    order: 22_sshd_all
    comment: 'Allow all clients access to sshd'
  vsftpd_all:
    client_list: ALL
    daemon_list: vsftpd
    order: 21_vsftpd_all
    comment: 'Allow all clients access to vsftpd'
```

#### Parameters

The following parameters are available in the `tcpwrappers::allows` class.

##### `rules`

Data type: `Hash`

Hash of rules for which each will result in creation of a resource using the define type tcpwrappers::allow.

Default value: {}

## Defined types

### tcpwrappers::allow

Define tcpwrappers::allow
===========================

Defined type which specifies and creates concat hosts.allow fragment

#### Examples

##### Creating a tcpwrappers rule in hosts.allow

```puppet
tcpwrappers::allow { 'allow sshd':
  client_list => 'ALL',
  daemon_list => 'sshd',
  $order      => '22_sshd_allow_all',
  $comment    =>  'Allow all clients to reach sshd daemon',
}
```

#### Parameters

The following parameters are available in the `tcpwrappers::allow` defined type.

##### `client_list`

Data type: `Variant[String,Array[String]]`

A list of hosts affected by the rule. Operators can also be included in the string as appropriate. No validation is done to ensure that the are valid for tcpwrappers.

##### `daemon_list`

Data type: `Variant[String,Array[String]]`

A list of daemons affected by the rule. Operators can also be included in the string as appropriate. No validation is done to ensure that they are valid for tcpwrappers.

##### `order`

Data type: `String`

Alphanumeric string that controls the ordering of concat fragments.

##### `allow_template`

Data type: `Optional[String]`

Template to use for fragment. Allows one to specify a different locally developed template instead of the module provided one.

Default value: 'tcpwrappers/allow.erb'

##### `comment`

Data type: `Optional[String]`

A comment to be included in the concat fragment to allow for readibility of hosts.allow. The module template automatically places a "#" character in front of the comment.

Default value: `undef`

##### `optional_actions`

Data type: `Optional[Variant[String,Array[String]]]`

An optional acction or list of actions to be carried out when the rule is hit. This defaults to allow; however, it can be overridden with an empty string to remove completely the options from the rule.

Default value: 'ALLOW'

